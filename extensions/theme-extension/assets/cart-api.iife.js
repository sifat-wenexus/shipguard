var CartAPI=function(f){"use strict";var O=Object.defineProperty;var J=(f,n,c)=>n in f?O(f,n,{enumerable:!0,configurable:!0,writable:!0,value:c}):f[n]=c;var h=(f,n,c)=>(J(f,typeof n!="symbol"?n+"":n,c),c);var m,v,I,L,q;const n=b;(function(w,s){const t=b,e=w();for(;;)try{if(parseInt(t(248))/1+-parseInt(t(243))/2+parseInt(t(231))/3*(-parseInt(t(181))/4)+parseInt(t(247))/5*(-parseInt(t(207))/6)+-parseInt(t(228))/7*(-parseInt(t(236))/8)+-parseInt(t(204))/9*(parseInt(t(193))/10)+parseInt(t(202))/11*(parseInt(t(250))/12)===s)break;e.push(e.shift())}catch{e.push(e.shift())}})(g,866345);const p=class p extends XMLHttpRequest{static[(m=n(217),v=n(182),n(222))](s,t,e=!0){const x=n;e?this.beforeListeners[s][x(194)](t):this[x(182)][s][x(194)](t)}static removeEventListener(s,t,e=!0){const x=n;e?this.beforeListeners[s][x(232)](t):this[x(182)][s][x(232)](t)}open(s,t,e=!0,x,a){const r=n;for(const i of p[r(217)][r(240)])i(this,s,t,e,x,a);super.open(s,t,e,x,a);for(const i of p[r(182)].open)i(this,s,t,e,x,a)}};h(p,m,{open:new Set}),h(p,v,{open:new Set});let c=p;const l=class l{constructor(s){h(this,I,new Set);h(this,L,{before:new Set,after:new Set});h(this,q,null);h(this,"cart",null);const t=n;if(this[t(233)]=s,!l[t(203)])l[t(203)]=this;else return l[t(203)];const e=async(a,r)=>{const i=t,u=typeof a===i(187)||a instanceof URL?a[i(214)]():a[i(180)],o=this[i(245)](u);if(o){const d=s(a,r);this[i(179)](o,d);const S=await d;return await this[i(179)](o),S}return s(a,r)};window[t(210)]=e,window[t(253)]=c,c[t(222)](t(240),(a,r,i)=>{const u=t,o=this.getCartEndpoint(i);if(o){const d=new Promise((S,E)=>{const y=b;a[y(222)](y(244),()=>{const N=y;S(void 0),this[N(179)](o)}),a[y(222)](y(175),E)});this[u(179)](o,d)}},!0);const x=localStorage[t(252)](t(209));x&&(this.queue=new Set(JSON[t(189)](x))),this[t(183)](this[t(206)][t(177)]>0),window[t(222)](t(221),a=>{const r=t;if(this[r(206)][r(177)]>0)return a.preventDefault(),"Cart updates are still in progress. Are you sure you want to leave?"})}[(I=n(206),L=n(216),q=n(218),n(212))](s,t=!1){const e=n;return this.listeners[t?e(199):"after"][e(194)](s),()=>{this[e(197)](s,t)}}[n(197)](s,t=!1){const e=n;this.listeners[e(t?199:230)][e(232)](s)}async[n(227)](s=!1){const t=n;if(this[t(184)]&&!s)return this[t(184)];const e=await fetch(t(186)),x=await e[t(196)]();return this.cart=x,x}async[n(191)](s,t=!0){const e=n,{cart:x}=await this[e(192)](e(191),{updates:s},t);return x}async[n(220)](s,t=!0){const e=n,{cart:x}=await this[e(192)](e(194),{items:s},t);return x}async remove(s,t=!0){const e=n,x=s[e(224)](r=>{var i;return(i=this[e(184)])==null?void 0:i[e(234)].some(u=>u.variant_id===r)});if(!x[e(195)])return await this[e(227)]();const{cart:a}=await this[e(192)](e(191),{updates:x[e(251)]((r,i)=>({...r,[i]:0}),{})},t);return a}[n(245)](s){const t=n,e=typeof s===t(187)?s:s[t(214)](),x=new URL(!e[t(246)]("http://")||!e[t(246)](t(176))?window[t(226)][t(237)]+"/"+e:e),a={add:t(211),update:t(200),change:t(174),clear:t(188)};for(const r in a){const i=a[r];if([i,i+t(215)][t(185)](u=>x[t(205)][t(229)](u)))return r}return null}async[n(179)](s,t){const e=n,x=this[e(184)];if(t){for(const i of this[e(216)][e(199)])i(x??await this[e(227)](!0),{requestType:s,updatedBy:e(238)},()=>new Promise(u=>{const o=()=>{const d=b;if(this[d(206)][d(177)]>0||this[d(218)])return setTimeout(o,800);u(t[d(208)](()=>this[d(227)](!0)))};setTimeout(o,800)}));await t;const r=await this[e(227)](!0);return JSON.stringify(x,null,0)===JSON[e(225)](r,null,0)?x:r}const a=await this[e(227)](!0);if(JSON[e(225)](x,null,0)===JSON[e(225)](a,null,0))return x;for(const r of this[e(216)][e(230)])r(a,{requestType:s,updatedBy:e(238)});return a}async runQueue(s=!1){const t=n;if(!this[t(218)]){for(const e of this[t(206)]){this[t(218)]=e,this[t(206)][t(232)](e),localStorage[t(242)]("wenexus-cart-queue",JSON.stringify(Array[t(198)](this[t(206)])));const x=await this.fetchFn.call(window,t(239)+e.type+".js",{method:t(235),headers:e[t(201)]?{"Content-Type":"application/json"}:void 0,body:e.payload?JSON[t(225)](e[t(201)]):void 0});window[t(219)](new CustomEvent("wenexus-cart-response-"+e.id,{detail:x}))}this[t(218)]=null,s&&(alert(t(223)),this[t(179)](t(194))),this[t(206)].size>0&&setTimeout(()=>this[t(183)](),10)}}[n(178)](s){return new Promise(t=>{const e=b;window.addEventListener("wenexus-cart-response-"+s,x=>t(x[e(249)]))})}async[n(192)](s,t,e=!0){const x=n,a=Math[x(241)]()[x(214)](36)[x(213)](2)+Date[x(190)]()[x(214)](36);this[x(206)][x(194)]({id:a,type:s,payload:t,trigger:e}),localStorage[x(242)](x(209),JSON[x(225)](Array[x(198)](this.queue))),this.runQueue();const r=await this[x(178)](a);return e?{cart:await this[x(179)](s),response:await r[x(196)]()}:{cart:await this.get(!e),response:await r[x(196)]()}}};h(l,"instance");let _=l;function g(){const w=["reduce","getItem","XMLHttpRequest","/cart/change","error","https://","size","waitForResponse","notifyListeners","url","6489460NEYTEz","afterListeners","runQueue","cart","some","/cart.js","string","/cart/clear","parse","now","update","request","24170eXKxYh","add","length","json","removeListener","from","before","/cart/update","payload","11xKbNbn","instance","207qaHafV","pathname","queue","558LyitOg","then","wenexus-cart-queue","fetch","/cart/add","addListener","slice","toString",".js","listeners","beforeListeners","running","dispatchEvent","append","beforeunload","addEventListener","Recovered from lost cart updates","filter","stringify","location","get","21VieQEX","endsWith","after","3CojsbH","delete","fetchFn","items","POST","4575840jpzffS","origin","api","/cart/","open","random","setItem","197182bZvcgo","load","getCartEndpoint","startsWith","36705XVwHEI","500598HCJZvS","detail","13308804HhHHXB"];return g=function(){return w},g()}function b(w,s){const t=g();return b=function(e,x){return e=e-174,t[e]},b(w,s)}return window.weNexusCartApi=new _(fetch),f.CartApi=_,Object.defineProperty(f,Symbol.toStringTag,{value:"Module"}),f}({});
